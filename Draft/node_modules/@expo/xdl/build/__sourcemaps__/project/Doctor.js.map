{"version":3,"sources":["project/Doctor.ts"],"names":["NO_ISSUES","WARNING","ERROR","FATAL","MIN_WATCHMAN_VERSION","MIN_NPM_VERSION","CORRECT_NPM_VERSION","WARN_NPM_VERSION_RANGES","BAD_NPM_VERSION_RANGES","EXPO_NO_DOCTOR","getenv","boolish","_isNpmVersionWithinRanges","npmVersion","ranges","some","range","semver","satisfies","_checkNpmVersionAsync","projectRoot","yarnVersionResponse","status","e","npmVersionResponse","stdout","trim","lt","ProjectUtils","logError","logWarning","clearNotification","_checkWatchmanVersionAsync","Watchman","isPlatformSupported","watchmanVersion","unblockAndGetVersionAsync","warningMessage","process","platform","validateWithSchema","_internal","exp","schema","configName","validateAssets","schemaErrorMessage","assetsErrorMessage","validator","Schemer","rootDir","validateSchemaAsync","SchemerError","errors","length","map","formatValidationError","join","validateAssetsAsync","Config","helpUrl","validationError","fieldPath","message","_validateExpJsonAsync","pkg","allowNetwork","skipSDKVersionRequirement","sdkVersion","env","EXPO_SKIP_MANIFEST_VALIDATION_TOKEN","sdkVersions","Versions","sdkVersionsAsync","Object","keys","ExpSchema","getSchemaAsync","reactNativeIssue","_validateReactNativeVersionAsync","validation","reactNativeVersionWarnings","reactNative","dependencies","devDependencies","peerDependencies","isDetached","test","reactNativeTag","match","sdkVersionObject","major","parseSdkVersionFromTag","_validateNodeModulesAsync","resolveFrom","silent","validateWithoutNetworkAsync","options","validateAsync","validateWithNetworkAsync","strict","expStatus","Math","max","nodeModulesStatus","validateExpoServersAsync","domains","attempts","Promise","all","domain","reachable","failures","filter","attempt","forEach","failure","console","log"],"mappings":"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","sourcesContent":["import { configFilename, ExpoConfig, getConfig, PackageJSONConfig } from '@expo/config';\nimport Schemer, { SchemerError, ValidationError } from '@expo/schemer';\nimport spawnAsync from '@expo/spawn-async';\nimport getenv from 'getenv';\nimport isReachable from 'is-reachable';\nimport resolveFrom from 'resolve-from';\nimport semver from 'semver';\n\nimport Config from '../Config';\nimport * as Versions from '../Versions';\nimport * as Watchman from '../Watchman';\nimport * as ExpSchema from './ExpSchema';\nimport * as ProjectUtils from './ProjectUtils';\n\nexport const NO_ISSUES = 0;\nexport const WARNING = 1;\nexport const ERROR = 2;\nexport const FATAL = 3;\n\nconst MIN_WATCHMAN_VERSION = '4.6.0';\nconst MIN_NPM_VERSION = '3.0.0';\nconst CORRECT_NPM_VERSION = 'latest';\nconst WARN_NPM_VERSION_RANGES = ['>= 5.0.0 < 5.7.0'];\nconst BAD_NPM_VERSION_RANGES = ['>= 5.0.0 <= 5.0.3'];\n\nconst EXPO_NO_DOCTOR = getenv.boolish('EXPO_NO_DOCTOR', false);\n\nfunction _isNpmVersionWithinRanges(npmVersion: string, ranges: string[]) {\n  return ranges.some(range => semver.satisfies(npmVersion, range));\n}\n\nasync function _checkNpmVersionAsync(projectRoot: string) {\n  try {\n    try {\n      const yarnVersionResponse = await spawnAsync('yarnpkg', ['--version']);\n      if (yarnVersionResponse.status === 0) {\n        return NO_ISSUES;\n      }\n    } catch (e) {}\n\n    const npmVersionResponse = await spawnAsync('npm', ['--version']);\n    const npmVersion = npmVersionResponse.stdout.trim();\n\n    if (\n      semver.lt(npmVersion, MIN_NPM_VERSION) ||\n      _isNpmVersionWithinRanges(npmVersion, BAD_NPM_VERSION_RANGES)\n    ) {\n      ProjectUtils.logError(\n        projectRoot,\n        'expo',\n        `Error: You are using npm version ${npmVersion}. We recommend the latest version ${CORRECT_NPM_VERSION}. To install it, run 'npm i -g npm@${CORRECT_NPM_VERSION}'.`,\n        'doctor-npm-version'\n      );\n      return WARNING;\n    } else if (_isNpmVersionWithinRanges(npmVersion, WARN_NPM_VERSION_RANGES)) {\n      ProjectUtils.logWarning(\n        projectRoot,\n        'expo',\n        `Warning: You are using npm version ${npmVersion}. There may be bugs in this version, use it at your own risk. We recommend version ${CORRECT_NPM_VERSION}.`,\n        'doctor-npm-version'\n      );\n    } else {\n      ProjectUtils.clearNotification(projectRoot, 'doctor-npm-version');\n    }\n  } catch (e) {\n    ProjectUtils.logWarning(\n      projectRoot,\n      'expo',\n      `Warning: Could not determine npm version. Make sure your version is >= ${MIN_NPM_VERSION} - we recommend ${CORRECT_NPM_VERSION}.`,\n      'doctor-npm-version'\n    );\n    return WARNING;\n  }\n\n  return NO_ISSUES;\n}\n\nasync function _checkWatchmanVersionAsync(projectRoot: string) {\n  // There's no point in checking any of this stuff if watchman isn't supported on this platform\n  if (!Watchman.isPlatformSupported()) {\n    ProjectUtils.clearNotification(projectRoot, 'doctor-watchman-version');\n    return;\n  }\n\n  const watchmanVersion = await Watchman.unblockAndGetVersionAsync(projectRoot);\n\n  // If we can't get the watchman version, `getVersionAsync` will return `null`\n  if (!watchmanVersion) {\n    // watchman is probably just not installed\n    ProjectUtils.clearNotification(projectRoot, 'doctor-watchman-version');\n    return;\n  }\n\n  if (semver.lt(watchmanVersion, MIN_WATCHMAN_VERSION)) {\n    let warningMessage = `Warning: You are using an old version of watchman (v${watchmanVersion}). This may cause problems for you.\\n\\nWe recommend that you either uninstall watchman (and XDE will try to use a copy it is bundled with) or upgrade watchman to a newer version, at least v${MIN_WATCHMAN_VERSION}.`;\n\n    // Add a note about homebrew if the user is on a Mac\n    if (process.platform === 'darwin') {\n      warningMessage += `\\n\\nIf you are using homebrew, try:\\nbrew uninstall watchman; brew install watchman`;\n    }\n    ProjectUtils.logWarning(projectRoot, 'expo', warningMessage, 'doctor-watchman-version');\n  } else {\n    ProjectUtils.clearNotification(projectRoot, 'doctor-watchman-version');\n  }\n}\n\nasync function validateWithSchema(\n  projectRoot: string,\n  {\n    // Extract internal from the config object.\n    _internal,\n    ...exp\n  }: ExpoConfig,\n  schema: any,\n  configName: string,\n  validateAssets: boolean\n): Promise<{ schemaErrorMessage: string | undefined; assetsErrorMessage: string | undefined }> {\n  let schemaErrorMessage;\n  let assetsErrorMessage;\n  const validator = new Schemer(schema, { rootDir: projectRoot });\n\n  // Validate the schema itself\n  try {\n    await validator.validateSchemaAsync(exp);\n  } catch (e) {\n    if (e instanceof SchemerError) {\n      schemaErrorMessage = `Error: Problem${\n        e.errors.length > 1 ? 's' : ''\n      } validating fields in ${configName}. See https://docs.expo.io/workflow/configuration/`;\n      schemaErrorMessage += e.errors.map(formatValidationError).join('');\n    }\n  }\n\n  if (validateAssets) {\n    try {\n      await validator.validateAssetsAsync(exp);\n    } catch (e) {\n      if (e instanceof SchemerError) {\n        assetsErrorMessage = `Error: Problem${\n          e.errors.length > 1 ? '' : 's'\n        } validating asset fields in ${configName}. See ${Config.helpUrl}`;\n        assetsErrorMessage += e.errors.map(formatValidationError).join('');\n      }\n    }\n  }\n  return { schemaErrorMessage, assetsErrorMessage };\n}\n\nfunction formatValidationError(validationError: ValidationError) {\n  return `\\n • ${validationError.fieldPath ? 'Field: ' + validationError.fieldPath + ' - ' : ''}${\n    validationError.message\n  }.`;\n}\n\nasync function _validateExpJsonAsync(\n  exp: ExpoConfig,\n  pkg: PackageJSONConfig,\n  projectRoot: string,\n  allowNetwork: boolean,\n  skipSDKVersionRequirement: boolean | undefined\n): Promise<number> {\n  if (!exp || !pkg) {\n    // getConfig already logged an error\n    return FATAL;\n  }\n\n  try {\n    await _checkWatchmanVersionAsync(projectRoot);\n  } catch (e) {\n    ProjectUtils.logWarning(\n      projectRoot,\n      'expo',\n      `Warning: Problem checking watchman version. ${e.message}.`,\n      'doctor-problem-checking-watchman-version'\n    );\n  }\n  ProjectUtils.clearNotification(projectRoot, 'doctor-problem-checking-watchman-version');\n\n  const sdkVersion = exp.sdkVersion;\n  const configName = configFilename(projectRoot);\n\n  // Warn if sdkVersion is UNVERSIONED\n  if (sdkVersion === 'UNVERSIONED' && !process.env.EXPO_SKIP_MANIFEST_VALIDATION_TOKEN) {\n    ProjectUtils.logError(\n      projectRoot,\n      'expo',\n      `Error: Using unversioned Expo SDK. Do not publish until you set sdkVersion in ${configName}`,\n      'doctor-unversioned'\n    );\n    return ERROR;\n  }\n  ProjectUtils.clearNotification(projectRoot, 'doctor-unversioned');\n  const sdkVersions = await Versions.sdkVersionsAsync();\n  if (!sdkVersions) {\n    ProjectUtils.logError(\n      projectRoot,\n      'expo',\n      `Error: Couldn't connect to SDK versions server`,\n      'doctor-versions-endpoint-failed'\n    );\n    return ERROR;\n  }\n  ProjectUtils.clearNotification(projectRoot, 'doctor-versions-endpoint-failed');\n\n  if (!skipSDKVersionRequirement && (!sdkVersion || !sdkVersions[sdkVersion])) {\n    ProjectUtils.logError(\n      projectRoot,\n      'expo',\n      `Error: Invalid sdkVersion. Valid options are ${Object.keys(sdkVersions).join(', ')}`,\n      'doctor-invalid-sdk-version'\n    );\n    return ERROR;\n  }\n  ProjectUtils.clearNotification(projectRoot, 'doctor-invalid-sdk-version');\n\n  // Skip validation if the correct token is set in env\n  if (sdkVersion && sdkVersion !== 'UNVERSIONED') {\n    try {\n      const schema = await ExpSchema.getSchemaAsync(sdkVersion);\n      const { schemaErrorMessage, assetsErrorMessage } = await validateWithSchema(\n        projectRoot,\n        exp,\n        schema,\n        configName,\n        allowNetwork\n      );\n\n      if (schemaErrorMessage) {\n        ProjectUtils.logError(projectRoot, 'expo', schemaErrorMessage, 'doctor-schema-validation');\n      } else {\n        ProjectUtils.clearNotification(projectRoot, 'doctor-schema-validation');\n      }\n      if (assetsErrorMessage) {\n        ProjectUtils.logError(\n          projectRoot,\n          'expo',\n          assetsErrorMessage,\n          `doctor-validate-asset-fields`\n        );\n      } else {\n        ProjectUtils.clearNotification(projectRoot, `doctor-validate-asset-fields`);\n      }\n      ProjectUtils.clearNotification(projectRoot, 'doctor-schema-validation-exception');\n      if (schemaErrorMessage || assetsErrorMessage) return ERROR;\n    } catch (e) {\n      ProjectUtils.logWarning(\n        projectRoot,\n        'expo',\n        `Warning: Problem validating ${configName}: ${e.message}.`,\n        'doctor-schema-validation-exception'\n      );\n    }\n  }\n\n  if (sdkVersion) {\n    const reactNativeIssue = await _validateReactNativeVersionAsync(\n      exp,\n      pkg,\n      projectRoot,\n      sdkVersions,\n      sdkVersion\n    );\n\n    if (reactNativeIssue !== NO_ISSUES) {\n      return reactNativeIssue;\n    }\n  }\n\n  // TODO: Check any native module versions here\n\n  return NO_ISSUES;\n}\n\nasync function _validateReactNativeVersionAsync(\n  exp: ExpoConfig,\n  pkg: PackageJSONConfig,\n  projectRoot: string,\n  sdkVersions: Versions.SDKVersions,\n  sdkVersion: string\n): Promise<number> {\n  if (Config.validation.reactNativeVersionWarnings) {\n    let reactNative = null;\n\n    if (pkg.dependencies?.['react-native']) {\n      reactNative = pkg.dependencies['react-native'];\n    } else if (pkg.devDependencies?.['react-native']) {\n      reactNative = pkg.devDependencies['react-native'];\n    } else if (pkg.peerDependencies?.['react-native']) {\n      reactNative = pkg.peerDependencies['react-native'];\n    }\n\n    // react-native is required\n    if (!reactNative) {\n      ProjectUtils.logError(\n        projectRoot,\n        'expo',\n        `Error: Can't find react-native in package.json dependencies`,\n        'doctor-no-react-native-in-package-json'\n      );\n      return ERROR;\n    }\n    ProjectUtils.clearNotification(projectRoot, 'doctor-no-react-native-in-package-json');\n\n    if (!exp.isDetached) {\n      return NO_ISSUES;\n\n      // (TODO-2017-07-20): Validate the react-native version if it uses\n      // officially published package rather than Expo fork. Expo fork of\n      // react-native was required before CRNA. We now only run the react-native\n      // validation of the version if we are using the fork. We should probably\n      // validate the version here as well such that it matches with the\n      // react-native version compatible with the selected SDK.\n    }\n\n    // Expo fork of react-native is required\n    if (!/expo\\/react-native/.test(reactNative)) {\n      ProjectUtils.logWarning(\n        projectRoot,\n        'expo',\n        `Warning: Not using the Expo fork of react-native. See ${Config.helpUrl}.`,\n        'doctor-not-using-expo-fork'\n      );\n      return WARNING;\n    }\n    ProjectUtils.clearNotification(projectRoot, 'doctor-not-using-expo-fork');\n\n    try {\n      const reactNativeTag = reactNative.match(/sdk-\\d+\\.\\d+\\.\\d+/)[0];\n      const sdkVersionObject = sdkVersions[sdkVersion];\n\n      // TODO: Want to be smarter about this. Maybe warn if there's a newer version.\n      if (\n        semver.major(Versions.parseSdkVersionFromTag(reactNativeTag)) !==\n        semver.major(Versions.parseSdkVersionFromTag(sdkVersionObject['expoReactNativeTag']))\n      ) {\n        ProjectUtils.logWarning(\n          projectRoot,\n          'expo',\n          `Warning: Invalid version of react-native for sdkVersion ${sdkVersion}. Use github:expo/react-native#${sdkVersionObject['expoReactNativeTag']}`,\n          'doctor-invalid-version-of-react-native'\n        );\n        return WARNING;\n      }\n      ProjectUtils.clearNotification(projectRoot, 'doctor-invalid-version-of-react-native');\n\n      ProjectUtils.clearNotification(projectRoot, 'doctor-malformed-version-of-react-native');\n    } catch (e) {\n      ProjectUtils.logWarning(\n        projectRoot,\n        'expo',\n        `Warning: ${reactNative} is not a valid version. Version must be in the form of sdk-x.y.z. Please update your package.json file.`,\n        'doctor-malformed-version-of-react-native'\n      );\n      return WARNING;\n    }\n  }\n\n  return NO_ISSUES;\n}\n\nasync function _validateNodeModulesAsync(projectRoot: string): Promise<number> {\n  // Check to make sure react-native is installed\n\n  if (resolveFrom.silent(projectRoot, 'react-native/local-cli/cli.js')) {\n    ProjectUtils.clearNotification(projectRoot, 'doctor-react-native-not-installed');\n  } else {\n    ProjectUtils.logError(\n      projectRoot,\n      'expo',\n      `Error: react-native is not installed. Please run \\`npm install\\` or \\`yarn\\` in your project directory.`,\n      'doctor-react-native-not-installed'\n    );\n    return FATAL;\n  }\n  return NO_ISSUES;\n}\n\nexport async function validateWithoutNetworkAsync(\n  projectRoot: string,\n  options: { skipSDKVersionRequirement?: boolean } = {}\n): Promise<number> {\n  return validateAsync(projectRoot, false, options.skipSDKVersionRequirement);\n}\n\nexport async function validateWithNetworkAsync(\n  projectRoot: string,\n  options: { skipSDKVersionRequirement?: boolean } = {}\n): Promise<number> {\n  return validateAsync(projectRoot, true, options.skipSDKVersionRequirement);\n}\n\nasync function validateAsync(\n  projectRoot: string,\n  allowNetwork: boolean,\n  skipSDKVersionRequirement: boolean | undefined\n): Promise<number> {\n  if (EXPO_NO_DOCTOR) {\n    return NO_ISSUES;\n  }\n\n  const { exp, pkg } = getConfig(projectRoot, {\n    strict: true,\n    skipSDKVersionRequirement,\n  });\n\n  ProjectUtils.clearNotification(projectRoot, 'doctor-config-json-not-read');\n\n  let status = await _checkNpmVersionAsync(projectRoot);\n  if (status === FATAL) {\n    return status;\n  }\n\n  const expStatus = await _validateExpJsonAsync(\n    exp,\n    pkg,\n    projectRoot,\n    allowNetwork,\n    skipSDKVersionRequirement\n  );\n  if (expStatus === FATAL) {\n    return expStatus;\n  }\n\n  status = Math.max(status, expStatus);\n\n  const nodeModulesStatus = await _validateNodeModulesAsync(projectRoot);\n  if (nodeModulesStatus > status) {\n    return nodeModulesStatus;\n  }\n\n  return status;\n}\n\nexport async function validateExpoServersAsync(projectRoot: string): Promise<number> {\n  const domains = [\n    'expo.io',\n    'expo.fyi',\n    'expo.dev',\n    'static.expo.dev',\n    // 'exp.host', - This is causing some intermittent false errors\n  ];\n  const attempts = await Promise.all(\n    domains.map(async domain => ({\n      domain,\n      reachable: await isReachable(domain),\n    }))\n  );\n  const failures = attempts.filter(attempt => !attempt.reachable);\n\n  if (failures.length) {\n    failures.forEach(failure => {\n      ProjectUtils.logWarning(\n        projectRoot,\n        'expo',\n        `Warning: could not reach \\`${failure.domain}\\`.`,\n        `doctor-server-dashboard-not-reachable-${failure.domain}`\n      );\n    });\n    console.log();\n    ProjectUtils.logWarning(\n      projectRoot,\n      'expo',\n      `We couldn't reach some of our domains, this might cause issues on our website or services.\\nPlease check your network configuration and try to access these domains in your browser.`,\n      'doctor-server-dashboard-not-reachable'\n    );\n    console.log();\n    return WARNING;\n  }\n  return NO_ISSUES;\n}\n"],"file":"../../project/Doctor.js","sourceRoot":"/@expo/xdl@59.0.24/src"}